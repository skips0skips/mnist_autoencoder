# Проект "Генерация изображений с помощью Conditional VAE на датасете MNIST"

В этом проекте мы исследовали и обучали условный вариационный автоэнкодер (Conditional VAE) на известном датасете рукописных цифр MNIST. Этот VAE позволяет генерировать новые изображения с цифрами, используя декодер.

# Архитектура 

На картинке ниже представлена архитектура простого Conditional VAE.

По сути, единственное отличие от обычного -- это то, что мы вместе с картинкой в первом слое энкодера и декодера передаем еще информацию о классе картинки.

То есть, в первый (входной) слой энкодера подается конкатенация картинки и информации о классе (например, вектора из девяти нулей и одной единицы). В первый слой декодера подается конкатенация латентного вектора и информации о классе.

<p align="center">
  <img src="https://github.com/skips0skips/mnist_autoencoder/blob/master/archetypes/archetypes_one.jpg"/>
</p>

<p align="center">
  <img src="https://github.com/skips0skips/mnist_autoencoder/blob/master/archetypes/archetypes_two.jpg"/>
</p>


# Структура репозитория

В репозитории вы найдете следующие папки:
1. Папка "api";
2. Папка "autoencoder_model";
3. Папка "mnist_data".

В первой папке располагается API проекта, которое реализовано с помощью библиотеки FastApi. 

Во второй папке находится все файлы связанные с моделью автоэнодера. Модель написана с помощью библиотеки Pytorch. 

В треьей папке лежит используемый датасет.

Структура второй папки:

- autoencoder_model/__pycache__: Директория, содержащая скомпилированные файлы Python-модулей для быстрого доступа к ним.

- autoencoder_model/datasets: Директория, содержащая модули для обработки и загрузки датасета MNIST.

- autoencoder_model/file: Директория, содержащая модуль для обработки файлов, таких как сохранение и загрузка моделей.

- autoencoder_model/test: Директория, содержащая модули для юнит-тестирования кода проекта.

- autoencoder_model/__init__.py: Пустой файл-инициализатор, который делает директорию autoencoder_model понятной Python как пакет.

- autoencoder_model/config.py: Модуль, содержащий настройки и конфигурацию проекта.

- autoencoder_model/data_preparation.py: Модуль, содержащий функции для предобработки данных, таких как масштабирование и нормализация.

- autoencoder_model/file_handler.py: Модуль, содержащий функции для обработки файлов, таких как сохранение и загрузка моделей.

- autoencoder_model/func_loss.py: Модуль, содержащий функции потерь для обучения модели.

- autoencoder_model/main.py: Модуль, содержащий главный класс Main, отвечающий за управление процессом обучения и генерации изображений.

- autoencoder_model/model.py: Модуль, содержащий определение модели Conditional VAE.

- autoencoder_model/plt_show.py: Модуль, содержащий функции для отображения и визуализации изображений и результатов обучения.

- autoencoder_model/requests.py: Модуль, содержащий функции для отправки HTTP-запросов.

- autoencoder_model/sampling.py: Модуль, содержащий функции для генерации новых изображений с помощью модели.

- autoencoder_model/train_pipeline.py: Модуль, содержащий функции для обучения модели и выполнения процесса обучения.

# Зависимости

Проект требует следующие зависимости:

1. Python 3.7 или новее
2. PyTorch 1.6 или новее
3. NumPy
4. Matplotlib
5. Fastapi

# Как использовать

Установите необходимые зависимости, запустив следующую команду: `pip install -r requirements.txt`

Запустите сервер с помощью команды: `uvicorn main:app --reload`

Откройте браузер и перейдите по адресу http://localhost:8000, чтобы получить доступ к главной странице приложения.

# API эндпоинты

GET /: Возвращает основную HTML-страницу с ссылкой на документацию API.

GET /start/: Возвращает HTML-форму для ввода числа.

POST /start/: Обрабатывает отправленную форму и запускает процесс получения изображений с указанным числом.

GET /get_image/{number}: Возвращает сгенерированные изображения, соответствующие указанному числу.

GET /get_config: Возвращает текущую конфигурацию модели.
